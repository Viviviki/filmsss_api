# Кинотеатр (афиша и билеты)

## Описание проекта и его функционал
Данный проект - это API-сервер для кинотеатра(вариант 4), созданный на Python с применением FastAPI. Он позволяет управлять афишей, расписанием сеансов, продажей билетов и отзывами, предоставляя удобный и эффективный интерфейс для взаимодействия.

Функционал проекта:

Фильм:

- Вывод всех фильмов с возможностью их фильтрации и пагинации
    
- Вывод сведений об одном фильме
    
- Добавление новых фильмов
    
- Редактирование существующих фильмов
    
- Удаление фильмов
    

Сеанс:

- Вывод всех сеансов
    
- Вывод сведений об одном сеансе
    
- Добавление новых сеансов
    
- Редактирование существующих сеансов
    
- Удаление сеансов
    

Билет:

- Вывод всех билетов

- Вывод сведений об одном билете

- Покупка билета

- Редактирование существующих билетов

- Удаление билетов

Отзыв:

- Получение всех пользовательских отзывов
    
- Получение сведений об одном отзыве
    
- Создание отзывов к фильму
    
- Редактирование отзывов
    
- Удаление отзывов
    

## Технологии

Проект построен на базе веб-фреймворка **FastAPI** версии 0.113.0. Для реализации функционала использованы следующие библиотеки:

- sqlalchemy 2.0.41
    
- pydantic-settings 2.9.1
    
- pymysql 1.1.1
    
- cryptography 45.0.3
    
- passlib 1.7.4
    
- PyJWT 2.10.1
    
- bcrypt 4.3.0
    

## Инструкции к запуску

Для запуска проекта выполните следующие шаги:
1. Создать базу данных в MySQL
	
2. Ввести данные от соединения MySQL в `.env`
	
3. Создание виртуального окружения (.venv) `python -m venv .venv`
    
4. Активация виртуального окружения `.venv\Scripts\activate`
        
5. Установка зависимостей `pip install -r requirements.txt`
    
6. Запуск посева данных (seeding) `python seed.py`
    
7. Запуск приложения `fastapi dev main.py`
    

## Описание к API

- Методология: RESTful API
    
- Способ передачи данных: через URL-параметры и/или в теле запроса
    
- Документация: доступна по адресу `http://127.0.0.1/docs`

| Метод | Маршрут                        | Параметры/тело запроса                                                                                           | Валидация                                                                                                   |
|-------|--------------------------------|-------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------|
| POST  | /login                         | JSON: `{login: str, password: str}`                                                                              | `login`: 2-20 символов; `password`: 8-20 символов, минимум 1 строчная, заглавная, цифра и спецсимвол       |
| GET   | /api/movies                    | Query: `page: int`, `limit: int`, `genre: str`, `minRating: float`                                               | `page > 0`, `limit: 1-100`, `minRating >= 0`                                                                |
| GET   | /api/movie/{id}                | Path: `id: int`                                                                                                   | `id` должен быть числом                                                                                     |
| POST  | /api/movie/                    | JSON: `{movie_name: str, duration: int, rate: float, genre_id: int}`                                             | `duration > 0`, `rate: 0-10`, `genre_id` должен существовать                                                |
| PUT   | /api/movie/{id}                | Path + JSON: как POST                                                                                            | То же, что и POST, плюс проверка существования фильма                                                       |
| DELETE| /api/movie/{id}                | Path: `id: int`                                                                                                   | Проверка существования фильма                                                                               |
| GET   | /api/sessions                  | -                                                                                                                 | -                                                                                                           |
| GET   | /api/session/{id}              | Path: `id: int`                                                                                                   | Проверка существования сеанса                                                                              |
| POST  | /api/session/                  | JSON: `{movie_id: int, hall_id: int, time: date, price: float}`                                                  | `price >= 0`, проверка существования фильма и зала                                                          |
| PUT   | /api/session/{id}              | Path + JSON: как POST                                                                                            | То же, что и POST, плюс проверка существования сеанса                                                      |
| DELETE| /api/session/{id}              | Path: `id: int`                                                                                                   | Проверка существования сеанса                                                                              |
| GET   | /api/tickets                   | -                                                                                                                 | -                                                                                                           |
| GET   | /api/tickets/{id}              | Path: `id: int`                                                                                                   | Проверка существования билета                                                                              |
| POST  | /api/ticket/                   | JSON: `{session_id: int, user_id: int, place_id: int}`                                                           | Проверка существования сеанса, пользователя, места                                                          |
| PUT   | /api/ticket/{id}               | Path + JSON: как POST                                                                                            | То же, что и POST, плюс проверка существования билета                                                      |
| DELETE| /api/ticket/{id}               | Path: `id: int`                                                                                                   | Проверка существования билета                                                                              |
| GET   | /api/comments                  | -                                                                                                                 | -                                                                                                           |
| GET   | /api/comments/{id}             | Path: `id: int`                                                                                                   | Проверка существования отзыва                                                                              |
| POST  | /api/comment/                  | JSON: `{description: str, movie_id: int, user_id: int}`                                                          | Проверка пользователя, фильма, запрет писать от чужого имени                                                |
| PUT   | /api/comment/{id}              | Path + JSON: как POST                                                                                            | Проверка фильма, авторства комментария, запрет редактирования чужого комментария                           |
| DELETE| /api/comment/{id}              | Path: `id: int`                                                                                                   | Проверка авторства, запрет на удаление чужого комментария                                                  |

## Описание ролей
В целях безопасности, в проекте реализовано управление доступом на основе ролей. Неавторизованные пользователи имеют доступ только к просмотру данных. Предусмотрены следующие роли:

- Зритель (login: user, password: N1v4nnn?)
    
- Кассир (login: seller, password: N1v4nnn?)
    
- Админ (login: admin, password: N1v4nnn?)
    

Возможности зрителя:

- Просмотр фильмов

- Покупка билета

- Добавлять отзывы к фильмам
    
- Изменять свои отзывы к фильмам
    
- Удалять свои отзывы   

Возможности кассиров:

- Создавать сеанс

- Изменить сеанс

- Удалить сеанс

- Создавать билет

- Изменить билет

- Удалить билет

Возможности админов:

- Добавлять фильм

- Изменить фильм

- Удалить фильм
    
## Контакты
Свяжитесь с нами:

- Телефон: 89826614260
    
- Почта: viktor.avronin@yandex.ru
    
- Telegram: [@Milaya_Pechenka](https://t.me/Milaya_Pechenka "null")